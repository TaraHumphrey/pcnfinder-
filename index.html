<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PCN Finder</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f8f8f8;
      padding: 20px;
      color: #000;
    }
    h1 {
      color: #00999E;
      text-align: center;
    }
    .search-box, .filters {
      max-width: 600px;
      margin: 20px auto;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    input, select {
      padding: 10px;
      font-size: 16px;
    }
    .pcn-table {
      max-width: 90%;
      margin: 20px auto;
      border-collapse: collapse;
      width: 100%;
      display: none;
    }
    .pcn-table th, .pcn-table td {
      border: 1px solid #ccc;
      padding: 10px;
      text-align: left;
    }
    .pcn-table th {
      background-color: #00999E;
      color: white;
    }
  </style>
</head>
<body>
  <h1>PCN Finder Tool</h1>
  <div class="search-box">
    <input type="text" id="searchInput" placeholder="Search by PCN Code or Name" oninput="searchPCNs()" />
    <div class="filters" id="filters" style="display: none;">
      <select id="regionFilter" onchange="searchPCNs()">
        <option value="">All Regions</option>
      </select>
      <select id="icbFilter" onchange="searchPCNs()">
        <option value="">All ICBs</option>
      </select>
    </div>
  </div>
  <table class="pcn-table" id="pcnTable">
    <thead>
      <tr>
        <th>PCN Code</th>
        <th>PCN Name</th>
        <th>GSUM Raw List</th>
        <th>Adjusted Population</th>
        <th>ICB Name</th>
        <th>Region</th>
      </tr>
    </thead>
    <tbody id="pcnTableBody"></tbody>
  </table>

  <script>
    const pcnData = [
      { code: "U49574", name: "ASCENT PCN", gsum: 35043, adj: 31126, icb: "NHS Bedfordshire, Luton and Milton Keynes Integrated Care Board", region: "East of England" },
      { code: "U74819", name: "CARITAS MEDICAL PCN", gsum: 65887, adj: 67928, icb: "NHS Bedfordshire, Luton and Milton Keynes Integrated Care Board", region: "East of England" },
      { code: "U09531", name: "CHILTERN HILLS PCN", gsum: 61755, adj: 59881, icb: "NHS Bedfordshire, Luton and Milton Keynes Integrated Care Board", region: "East of England" },
      { code: "U35004", name: "CROWN PCN", gsum: 35883, adj: 35609, icb: "NHS Bedfordshire, Luton and Milton Keynes Integrated Care Board", region: "East of England" },
      { code: "U39446", name: "EAST BEDFORD PCN", gsum: 57324, adj: 55087, icb: "NHS Bedfordshire, Luton and Milton Keynes Integrated Care Board", region: "East of England" }
    ];

    function populateFilters() {
      const regionFilter = document.getElementById("regionFilter");
      const icbFilter = document.getElementById("icbFilter");
      const regions = [...new Set(pcnData.map(p => p.region))];
      const icbs = [...new Set(pcnData.map(p => p.icb))];

      regions.forEach(r => {
        const opt = document.createElement("option");
        opt.value = r;
        opt.textContent = r;
        regionFilter.appendChild(opt);
      });
      icbs.forEach(i => {
        const opt = document.createElement("option");
        opt.value = i;
        opt.textContent = i;
        icbFilter.appendChild(opt);
      });
    }

    function searchPCNs() {
      const query = document.getElementById("searchInput").value.toLowerCase();
      const region = document.getElementById("regionFilter").value;
      const icb = document.getElementById("icbFilter").value;
      const tbody = document.getElementById("pcnTableBody");
      tbody.innerHTML = "";

      const filtered = pcnData.filter(p => {
        const match = p.code.toLowerCase().includes(query) || p.name.toLowerCase().includes(query);
        const matchRegion = region === "" || p.region === region;
        const matchICB = icb === "" || p.icb === icb;
        return match && matchRegion && matchICB;
      });

      if (query && filtered.length > 0) {
        document.getElementById("pcnTable").style.display = "table";
        document.getElementById("filters").style.display = "flex";

        filtered.forEach(p => {
          const row = `<tr>
            <td>${p.code}</td>
            <td>${p.name}</td>
            <td>${p.gsum.toLocaleString()}</td>
            <td>${p.adj.toLocaleString()}</td>
            <td>${p.icb}</td>
            <td>${p.region}</td>
          </tr>`;
          tbody.innerHTML += row;
        });
      } else {
        document.getElementById("pcnTable").style.display = "none";
        document.getElementById("filters").style.display = "none";
      }
    }

    populateFilters();
  </script>
</body>
</html>
